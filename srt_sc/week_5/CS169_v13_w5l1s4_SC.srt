1
00:00:00,000 --> 00:00:04,000
为了确保大家都明白，再出一道题。

2
00:00:04,004 --> 00:00:08,004
本彼得迪多说，“可以将任何内容放进session吗？”

3
00:00:08,008 --> 00:00:12,008
“可以，你可以这么做？”“可以，但是不应该这么做？”“不可以，

4
00:00:12,012 --> 00:00:16,012
因为一般不能在散列表里放入任何内容。”“不可以，

5
00:00:16,016 --> 00:00:18,016
因为session并不是真正的散列表，只是看起来像，直到它该在对话之间被保存，

6
00:00:18,018 --> 00:00:23,018
然后不再是散列表？”

7
00:00:23,023 --> 00:00:25,023
我们今天将继续保持高体力消耗模式。

8
00:00:25,025 --> 00:00:27,025
对这个问题大家存在足够多的分歧，我认为你们应该讨论一下。

9
00:00:27,027 --> 00:00:30,027
我们再投一次票。

10
00:00:30,030 --> 00:00:36,030
我看到集中选择的颜色是…我看到的是绿色，对吗？我想是绿色吧？

11
00:00:36,036 --> 00:00:41,036
很好，我们来看看，为什么绿色是

12
00:00:41,041 --> 00:00:43,041
正确答案。通常都有人选蓝色。蓝色答案

13
00:00:43,043 --> 00:00:47,043
是一种合理的选择，但我认为选绿色答案更好。

14
00:00:47,047 --> 00:00:51,047
以下是原因。我说session并不是真正的散列表，

15
00:00:51,051 --> 00:00:53,051
它只是看起来像散列表。记住，鸭子类型之所以这么叫是因为它听起来也像鸭子。

16
00:00:53,053 --> 00:00:57,053
这是一只奇异的鸭子。

17
00:00:57,057 --> 00:01:00,057
session听起来像散列表并没有什么关系。事实上，你可以将你对散列表做的任何事情

18
00:01:00,000 --> 00:01:02,060
应用在session上，它不会抱怨的。

19
00:01:02,062 --> 00:01:04,062
你可以虐待它，也可以把它扔到墙上。

20
00:01:04,064 --> 00:01:08,064
问题是，在某个时候session必须被序列化。

21
00:01:08,068 --> 00:01:10,068
它必须被保存，这样才能在下一个请求时恢复。

22
00:01:10,070 --> 00:01:14,070
现在，这绝对是我几分钟前说的情况。

23
00:01:14,074 --> 00:01:18,074
你可以选择将session中的数据

24
00:01:18,078 --> 00:01:22,078
存储在数据库或存储在非SQL的数据库里。

25
00:01:22,082 --> 00:01:25,082
如果你这么做，你可以让session任意大。

26
00:01:25,085 --> 00:01:28,085
你只需要保证cookie中的保持的那部分session

27
00:01:28,088 --> 00:01:30,088
不要太大就可以。这不是session的问题，

28
00:01:30,090 --> 00:01:33,090
而是cookie机制的问题。

29
00:01:33,093 --> 00:01:36,093
有些人用不同的方式，也可以解决问题。你可以说；

30
00:01:36,096 --> 00:01:38,096
我要将session放入数据库，

31
00:01:38,098 --> 00:01:41,098
让session对象变得更大。也可以说我要重构

32
00:01:41,101 --> 00:01:43,101
我所认为的session。或者我要创建一个新模型

33
00:01:43,103 --> 00:01:46,103
来代表我真正关心的信息。

34
00:01:46,106 --> 00:01:48,106
这个模型将会长久存在于数据库中就像其他所有模型一样。

35
00:01:48,108 --> 00:01:51,108
我的session很小，因为它只需要

36
00:01:51,111 --> 00:01:54,111
像我所关心的模型实例的ID那样存储。

37
00:01:54,114 --> 00:01:57,114
那是更优雅的重构，可能更有REST风格

38
00:01:57,117 --> 00:01:59,117
但这不是唯一的方法。没错，绿色确实是这道题的正确答案。

39
00:01:59,119 --> 00:02:02,119
技术上我们可以做到，但这不是一个好主意，

40
00:02:02,122 --> 00:02:05,122
因为在某些时候，你可能会最终搬起石头砸自己的脚。

41
00:02:05,125 --> 00:02:09,125
你确实可以将任何对象放入散列表。红色答案是错的。

42
00:02:09,129 --> 00:02:13,129
想撞墙？别，

43
00:02:13,133 --> 00:02:16,133
这次其实是在锻炼你的总结能力。
